package data.DAO;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.ArrayList;

import data.Util.DbUtil;
import data.VO.Veiculo;

public class VeiculoRepo {
	private Connection connection;

	public VeiculoRepo() {
		connection = DbUtil.getConnection();
	}

	public void add(Veiculo p) {

		try {

			PreparedStatement preparedStatement = connection.prepareStatement("exec sp_tbVeiculo_I ?,?,?,?"
					+ "INSERT INTO TBVEICULO " + "(PLACA, IdCliente, IdCor, MODELO)" + " VALUES (?,?,?,?)");

			preparedStatement.setString(1, p.getPlaca());
			preparedStatement.setInt(2, p.getIdCliente());
			preparedStatement.setInt(3, p.getIdCor());
			preparedStatement.setString(4, p.getModelo());

			preparedStatement.execute();

		} catch (Exception e) {
			e.printStackTrace();
		}

	} // addPeople

	public void update(Veiculo p) {
		try {

			PreparedStatement preparedStatement = connection.prepareStatement("exec sp_tbVeiculo_U ?,?,?,?,?"
					+ "UPDATE TBVEICULO SET " + "PLACA = ?, IdCliente = ?, IdCor = ?, MODELO = ?" + "where ID = ?");

			preparedStatement.setString(1, p.getPlaca());
			preparedStatement.setInt(2, p.getIdCliente());
			preparedStatement.setInt(3, p.getIdCor());
			preparedStatement.setString(4, p.getModelo());

			preparedStatement.setInt(5, p.getId());

			preparedStatement.execute();

		} catch (Exception e) {
			e.printStackTrace();
		}
	}

	public void del(Veiculo p) {
		try {

			PreparedStatement preparedStatement = connection
					.prepareStatement("exec sp_tbVeiculo_D ?" + "DELETE FROM TBVEICULO WHERE ID = ?");

			preparedStatement.setInt(1, p.getId());

			preparedStatement.execute();

		} catch (Exception e) {
			e.printStackTrace();
		}
	}

	public Veiculo get(Veiculo p) {
		
		PreparedStatement stmt;
		ResultSet rs;		
		Veiculo item = null;
		
		try {
			stmt = (PreparedStatement) this.connection.prepareStatement("select * from TBVEICULO");
			rs = (ResultSet) stmt.executeQuery();



			if (rs.next()) {
				item = new Veiculo();
				item.setId(rs.getInt(""));
			}			

			rs.close();
			stmt.close();
			
		} catch (Exception e) {
			e.printStackTrace();
		}

		return item;
	}

	public ArrayList<Veiculo> listPeople(Veiculo p) {
		PreparedStatement stmt;
		ResultSet rs;	
		ArrayList<Veiculo> veiculos = new ArrayList<Veiculo>();

		try {
			stmt = (PreparedStatement) this.connection.prepareStatement("select * from TBVEICULO");
			rs = (ResultSet) stmt.executeQuery();
			
			while (rs.next()) {
				Veiculo item = new Veiculo();
				item.setId(rs.getInt(""));
				veiculos.add(item);
			}			

			rs.close();
			stmt.close();
			
		} catch (Exception e) {
			e.printStackTrace();
		}
		return veiculos;
	}
}
