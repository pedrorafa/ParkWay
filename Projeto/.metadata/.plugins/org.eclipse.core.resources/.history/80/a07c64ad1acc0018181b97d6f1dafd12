package data.DAO;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.util.ArrayList;

import data.Util.DbUtil;
import data.VO.Cliente;

public class ClienteRepo {
	private Connection connection;

	public ClienteRepo() {
		connection = DbUtil.getConnection();
	}

	public void addPeople(Cliente p) {

		try {

			PreparedStatement preparedStatement = connection.prepareStatement(
					"INSERT INTO CLIENTE " + "(CPF, Nome, tipodelogradouro , logradouro, estado, cidade, bairro, CEP)"
							+ " VALUES (?,?,?,?,?,?,?,?)");

			preparedStatement.setString(1, p.getCPF());
			preparedStatement.setString(2, p.getNome());
			preparedStatement.setString(3, p.getEndereco().getTipodelogradouro());
			preparedStatement.setString(4, p.getEndereco().getLogradouro());
			preparedStatement.setString(5, p.getEndereco().getEstado());
			preparedStatement.setString(6, p.getEndereco().getCidade());
			preparedStatement.setString(7, p.getEndereco().getBairro());
			preparedStatement.setString(8, p.getEndereco().getCep());

			preparedStatement.execute();

		} catch (Exception e) {
			e.printStackTrace();
		}

	} // addPeople

	public void updatePeople(Cliente p) {
		try {

			PreparedStatement preparedStatement = connection.prepareStatement("UPDATE CLIENTE SET "
					+ "Nome = ?, tipodelogradouro = ?, logradouro = ?, estado = ?, cidade = ?, bairro = ?, CEP = ? where CPF = ?"
					+ " VALUES (?,?,?,?,?,?,?,?)");

			preparedStatement.setString(1, p.getNome());
			preparedStatement.setString(2, p.getEndereco().getTipodelogradouro());
			preparedStatement.setString(3, p.getEndereco().getLogradouro());
			preparedStatement.setString(4, p.getEndereco().getEstado());
			preparedStatement.setString(5, p.getEndereco().getCidade());
			preparedStatement.setString(6, p.getEndereco().getBairro());
			preparedStatement.setString(7, p.getEndereco().getCep());

			preparedStatement.setString(8, p.getCPF());

			preparedStatement.execute();

		} catch (Exception e) {
			e.printStackTrace();
		}
	}

	public void delPeople(Cliente p) {

	}

	public Cliente getPeople(Cliente p) {
		return new Cliente(); // TODO: Work on it
	}

	public ArrayList<Cliente> listPeople(Cliente p) {
		return new ArrayList<Cliente>(); // TODO: Work on it
	}
}
